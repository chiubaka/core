{"version":3,"sources":["../src/auth/components/SocialLoginButton.tsx"],"names":[],"mappings":";;AAAA,+BAA+B;AAC/B,6CAAsC;AAGtC,sCAAsD;AAatD,MAAM,qBAAsB,SAAQ,KAAK,CAAC,SAAkC;IAsBnE,MAAM;QACX,MAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC;QAE7C,OAAO,CACL,2BACE,SAAS,EAAE,gCAAgC,YAAY,EAAE,EACzD,IAAI,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE;YAE/B,8BAAM,SAAS,EAAE,SAAS,YAAY,EAAE,GAAG;;YAC7B,YAAY,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CACjE,CACL,CAAC;IACJ,CAAC;;AAjCa,qCAAe,GAAiC;IAC5D,QAAQ,EAAE,6CAA6C;IACvD,MAAM,EAAE,8CAA8C;CACvD,CAAC;AAEF,4GAA4G;AAC5G,sGAAsG;AACxF,2CAAqB,GAAiC;IAClE,MAAM,EAAE,eAAe;CACxB,CAAC;AAEY,kDAA4B,GAAwD;IAChG,QAAQ,EAAE;QACR,aAAa,EAAE,MAAM;KACtB;IACD,MAAM,EAAE;QACN,aAAa,EAAE,MAAM;QACrB,KAAK,EAAE,eAAe;KACvB;CACF,CAAC;AAiBJ,SAAS,eAAe,CAAC,KAAiC,EACjC,QAAoC;IAC3D,MAAM,EAAE,QAAQ,EAAE,YAAY,EAAE,GAAG,QAAQ,CAAC;IAC5C,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,KAAK,CAAC,OAAO,CAAC;IACjD,MAAM,sBAAsB,GAAG,KAAK,CAAC,IAAI,CAAC,sBAAsB,CAAC;IACjE,MAAM,aAAa,GAAG,qBAAqB,CAAC,qBAAqB,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;IAEzF,MAAM,WAAW,GAAG,4BAAsB,CACxC,QAAQ,EACR,sBAAsB,EACtB,aAAa,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,YAAY,EAC5C,IAAI,EACJ,MAAM,CACP,CAAC;IAEF,IAAI,CAAC,CAAC,YAAY,IAAI,qBAAqB,CAAC,eAAe,CAAC,EAAE;QAC5D,OAAO,CAAC,KAAK,CAAC,qCAAqC,YAAY,GAAG,CAAC,CAAC;KACrE;IAED,MAAM,aAAa,GAAG,qBAAqB,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;IAC1E,IAAI,SAAS,GAAG,GAAG,aAAa,cAAc,QAAQ,iBAAiB,WAAW,EAAE,CAAC;IACrF,MAAM,oBAAoB,GAAG,qBAAqB,CAAC,4BAA4B,CAAC,YAAY,CAAC,CAAC;IAE9F,IAAI,oBAAoB,EAAE;QACxB,KAAK,MAAM,GAAG,IAAI,oBAAoB,EAAE;YACtC,IAAI,oBAAoB,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;gBAC5C,SAAS,IAAI,IAAI,GAAG,IAAI,oBAAoB,CAAC,GAAG,CAAC,EAAE,CAAC;aACrD;SACF;KACF;IAED,OAAO;QACL,SAAS;KACV,CAAC;AACJ,CAAC;AAEY,QAAA,iBAAiB,GAAG,qBAAO,CAAC,eAAe,CAAC,CAAC,qBAAqB,CAAC,CAAC","file":"../../../auth/components/SocialLoginButton.js","sourcesContent":["import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { IServiceState } from \"../../app/model/index\";\nimport { IAuthState } from \"../model/AuthenticationState\";\nimport { buildOAuth2CallbackUri } from \"../utils/uri\";\n\nexport interface ISocialLoginButtonOwnProps {\n  clientId: string;\n  providerName: string;\n}\n\nexport interface ISocialLoginButtonStateProps {\n  oAuth2Uri: string;\n}\n\nexport interface ISocialLoginButtonProps extends ISocialLoginButtonOwnProps, ISocialLoginButtonStateProps {}\n\nclass SocialLoginButtonImpl extends React.Component<ISocialLoginButtonProps> {\n  public static OAUTH2_GATEWAYS: {[provider: string]: string} = {\n    facebook: \"https://www.facebook.com/v2.10/dialog/oauth\",\n    google: \"https://accounts.google.com/o/oauth2/v2/auth\",\n  };\n\n  // Provides provider providerName aliases as shims since social-app-django differentiates between Google and\n  // Google OAuth2. We don't support anything other than OAuth2, so internally there's no need for that.\n  public static OAUTH2_PROVIDER_ALIAS: {[provider: string]: string} = {\n    google: \"google-oauth2\",\n  };\n\n  public static OAUTH2_ADDITIONAL_PARAMETERS: {[provider: string]: {[parameter: string]: string}} = {\n    facebook: {\n      response_type: \"code\",\n    },\n    google: {\n      response_type: \"code\",\n      scope: \"profile email\",\n    },\n  };\n\n  public render(): JSX.Element {\n    const providerName = this.props.providerName;\n\n    return (\n      <a\n        className={`btn btn-block btn-social btn-${providerName}`}\n        href={`${this.props.oAuth2Uri}`}\n      >\n        <span className={`fa fa-${providerName}`}/>\n        Sign in with {providerName[0].toUpperCase() + providerName.slice(1)}\n      </a>\n    );\n  }\n}\n\nfunction mapStateToProps(state: IAuthState & IServiceState,\n                         ownProps: ISocialLoginButtonOwnProps): ISocialLoginButtonStateProps {\n  const { clientId, providerName } = ownProps;\n  const { hostname, port, useSsl } = state.service;\n  const oAuth2CallbackBasePath = state.auth.oAuth2CallbackBasePath;\n  const providerAlias = SocialLoginButtonImpl.OAUTH2_PROVIDER_ALIAS[ownProps.providerName];\n\n  const redirectUri = buildOAuth2CallbackUri(\n    hostname,\n    oAuth2CallbackBasePath,\n    providerAlias ? providerAlias : providerName,\n    port,\n    useSsl,\n  );\n\n  if (!(providerName in SocialLoginButtonImpl.OAUTH2_GATEWAYS)) {\n    console.error(`Unrecognized social auth provider ${providerName}.`);\n  }\n\n  const oAuth2Gateway = SocialLoginButtonImpl.OAUTH2_GATEWAYS[providerName];\n  let oAuth2Uri = `${oAuth2Gateway}?client_id=${clientId}&redirect_uri=${redirectUri}`;\n  const additionalParameters = SocialLoginButtonImpl.OAUTH2_ADDITIONAL_PARAMETERS[providerName];\n\n  if (additionalParameters) {\n    for (const key in additionalParameters) {\n      if (additionalParameters.hasOwnProperty(key)) {\n        oAuth2Uri += `&${key}=${additionalParameters[key]}`;\n      }\n    }\n  }\n\n  return {\n    oAuth2Uri,\n  };\n}\n\nexport const SocialLoginButton = connect(mapStateToProps)(SocialLoginButtonImpl);\n"]}