{"version":3,"sources":["../src/auth/utils/storage.ts"],"names":[],"mappings":";;AAAA,iCAAiC;AACjC,+BAAyC;AAG5B,QAAA,SAAS,GAAG,OAAO,CAAC;AACpB,QAAA,QAAQ,GAAG,MAAM,CAAC;AAClB,QAAA,iBAAiB,GAAG,cAAc,CAAC;AAEhD,6FAA6F;AAC7F,6EAA6E;AAC7E,SAAgB,OAAO,CAAC,IAAW,EAAE,UAAkB,CAAC;IACtD,YAAY,CAAC,OAAO,CAAC,gBAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;IACrD,GAAG,CAAC,gBAAQ,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;AAC/B,CAAC;AAHD,0BAGC;AAED,SAAgB,OAAO;IACrB,OAAO,GAAG,CAAC,gBAAQ,CAAU,CAAC;AAChC,CAAC;AAFD,0BAEC;AAED,SAAgB,UAAU;IACxB,MAAM,CAAC,gBAAQ,CAAC,CAAC;AACnB,CAAC;AAFD,gCAEC;AAED,SAAgB,QAAQ,CAAC,KAAa,EAAE,UAAkB,CAAC;IACzD,GAAG,CAAC,iBAAS,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;AACjC,CAAC;AAFD,4BAEC;AAED,SAAgB,QAAQ;IACtB,OAAO,GAAG,CAAC,iBAAS,CAAC,CAAC;AACxB,CAAC;AAFD,4BAEC;AAED,SAAgB,WAAW;IACzB,MAAM,CAAC,iBAAS,CAAC,CAAC;AACpB,CAAC;AAFD,kCAEC;AAED,SAAgB,eAAe,CAAC,YAAoB;IAClD,GAAG,CAAC,yBAAiB,EAAE,YAAY,CAAC,CAAC;AACvC,CAAC;AAFD,0CAEC;AAED,SAAgB,eAAe;IAC7B,OAAO,GAAG,CAAC,yBAAiB,CAAC,CAAC;AAChC,CAAC;AAFD,0CAEC;AAED,SAAgB,kBAAkB;IAChC,MAAM,CAAC,yBAAiB,CAAC,CAAC;AAC5B,CAAC;AAFD,gDAEC;AAQD,SAAS,GAAG,CAAC,GAAW,EAAE,IAAS,EAAE,OAAgB;IACnD,MAAM,SAAS,GAAG;QAChB,SAAS,EAAE,MAAM,EAAE,CAAC,MAAM,EAAE;QAC5B,OAAO;QACP,IAAI;KACL,CAAC;IACF,YAAY,CAAC,OAAO,CAAC,GAAG,EAAE,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC;AACvD,CAAC;AAED,SAAS,GAAG,CAAC,GAAW;IACtB,MAAM,IAAI,GAAG,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;IAEvC,IAAI,wBAAiB,CAAC,IAAI,CAAC,EAAE;QAC3B,OAAO,IAAI,CAAC;KACb;IAED,MAAM,SAAS,GAAsB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;IACtD,0BAA0B;IAC1B,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,SAAS,CAAC;IAC/C,IAAI,CAAC,OAAO,IAAI,MAAM,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,GAAG,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC,EAAE;QACzE,OAAO,IAAI,CAAC;KACb;SAAM;QACL,YAAY,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;QAC7B,OAAO,IAAI,CAAC;KACb;AACH,CAAC;AAED,SAAS,MAAM,CAAC,GAAW;IACzB,YAAY,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;AAC/B,CAAC","file":"../../../auth/utils/storage.js","sourcesContent":["import * as moment from \"moment\";\nimport { isNullOrUndefined } from \"util\";\nimport { IUser } from \"../../app/types/index\";\n\nexport const TOKEN_KEY = \"token\";\nexport const USER_KEY = \"user\";\nexport const REDIRECT_PATH_KEY = \"redirectPath\";\n\n// TODO: Default value of 1 here, represents the 1 day value placed in the Django server code\n// for auth token expiry. Would be great to not define this in both places...\nexport function setUser(user: IUser, expires: number = 1) {\n  localStorage.setItem(USER_KEY, JSON.stringify(user));\n  set(USER_KEY, user, expires);\n}\n\nexport function getUser(): IUser {\n  return get(USER_KEY) as IUser;\n}\n\nexport function removeUser() {\n  remove(USER_KEY);\n}\n\nexport function setToken(token: string, expires: number = 1) {\n  set(TOKEN_KEY, token, expires);\n}\n\nexport function getToken(): string {\n  return get(TOKEN_KEY);\n}\n\nexport function removeToken() {\n  remove(TOKEN_KEY);\n}\n\nexport function setRedirectPath(redirectPath: string) {\n  set(REDIRECT_PATH_KEY, redirectPath);\n}\n\nexport function getRedirectPath() {\n  return get(REDIRECT_PATH_KEY);\n}\n\nexport function removeRedirectPath() {\n  remove(REDIRECT_PATH_KEY);\n}\n\ninterface IStorageContainer {\n  createdAt: string;\n  expires: number;\n  data: any;\n}\n\nfunction set(key: string, data: any, expires?: number) {\n  const container = {\n    createdAt: moment().format(),\n    expires,\n    data,\n  };\n  localStorage.setItem(key, JSON.stringify(container));\n}\n\nfunction get(key: string): any {\n  const item = localStorage.getItem(key);\n\n  if (isNullOrUndefined(item)) {\n    return null;\n  }\n\n  const container: IStorageContainer = JSON.parse(item);\n  // If expired, return null\n  const { createdAt, expires, data } = container;\n  if (!expires || moment().isBefore(moment(createdAt).add(expires, \"days\"))) {\n    return data;\n  } else {\n    localStorage.removeItem(key);\n    return null;\n  }\n}\n\nfunction remove(key: string) {\n  localStorage.removeItem(key);\n}\n"]}